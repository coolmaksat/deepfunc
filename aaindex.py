import numpy

AALETTER = [
    'A', 'R', 'N', 'D', 'C', 'Q', 'E', 'G', 'H', 'I',
    'L', 'K', 'M', 'F', 'P', 'S', 'T', 'W', 'Y', 'V']
AANUM = len(AALETTER)
AAINDEX = dict()
for i in range(len(AALETTER)):
    AAINDEX[AALETTER[i]] = i

AACOOC = [
    [5884002, 3205710, 1905944, 2946970, 671191, 3820989, 2205260, 4044434, 1175639, 3324574, 5665790, 3098619, 1374838, 1964353, 2413867, 3270650, 2867441, 543741, 1431436, 4064514],
    [3205710, 2557514, 1319372, 1864165, 480224, 2488050, 1494981, 2672533, 888389, 2227916, 3786571, 2100291, 883227, 1421844, 1585854, 2189364, 1804655, 432622, 1126035, 2568410],
    [1905944, 1319372, 1370658, 1367541, 360338, 1670432, 968674, 1737257, 585174, 1818226, 2627287, 1601350, 630739, 1113780, 1254930, 1680865, 1370496, 304583, 848768, 1799821],
    [2946970, 1864165, 1367541, 2110544, 470471, 2454441, 1193769, 2500182, 786875, 2508478, 3781743, 1964172, 856692, 1580002, 1682989, 2190094, 1845095, 427053, 1175587, 2823981],
    [671191, 480224, 360338, 470471, 187298, 543913, 327672, 700445, 232631, 513388, 801719, 463369, 180233, 372089, 426351, 605335, 461525, 105307, 289147, 615557],
    [3820989, 2488050, 1670432, 2454441, 543913, 3512228, 1701808, 2921981, 890306, 2974485, 4656296, 2789627, 1105963, 1713564, 1907228, 2481172, 2254054, 461867, 1261990, 3279189],
    [2205260, 1494981, 968674, 1193769, 327672, 1701808, 1436804, 1674049, 608123, 1539922, 2695386, 1434202, 628963, 962994, 1180990, 1524624, 1254418, 313131, 767502, 1710614],
    [4044434, 2672533, 1737257, 2500182, 700445, 2921981, 1674049, 4021738, 1133107, 2969898, 4437086, 2698064, 1131524, 1924913, 2299123, 3145160, 2696811, 518083, 1441995, 3493968],
    [1175639, 888389, 585174, 786875, 232631, 890306, 608123, 1133107, 494844, 926032, 1531055, 771513, 340425, 640163, 801772, 948654, 792418, 179834, 499121, 1018183],
    [3324574, 2227916, 1818226, 2508478, 513388, 2974485, 1539922, 2969898, 926032, 2291248, 3338346, 2503743, 829049, 1436730, 1787875, 2544161, 2162933, 374206, 1104934, 2671617],
    [5665790, 3786571, 2627287, 3781743, 801719, 4656296, 2695386, 4437086, 1531055, 3338346, 5867834, 3841386, 1360101, 2255881, 2998416, 4179471, 3390732, 672387, 1718966, 4114646],
    [3098619, 2100291, 1601350, 1964172, 463369, 2789627, 1434202, 2698064, 771513, 2503743, 3841386, 2798884, 943112, 1436546, 1571597, 2261978, 1949039, 404070, 1143727, 2653183],
    [1374838, 883227, 630739, 856692, 180233, 1105963, 628963, 1131524, 340425, 829049, 1360101, 943112, 407588, 548111, 699875, 974826, 816691, 156789, 404198, 1032328],
    [1964353, 1421844, 1113780, 1580002, 372089, 1713564, 962994, 1924913, 640163, 1436730, 2255881, 1436546, 548111, 1030080, 1210879, 1746427, 1379110, 288213, 792413, 1681499],
    [2413867, 1585854, 1254930, 1682989, 426351, 1907228, 1180990, 2299123, 801772, 1787875, 2998416, 1571597, 699875, 1210879, 1853296, 2110025, 1802701, 341930, 928293, 2220318],
    [3270650, 2189364, 1680865, 2190094, 605335, 2481172, 1524624, 3145160, 948654, 2544161, 4179471, 2261978, 974826, 1746427, 2110025, 3446622, 2323127, 461284, 1238396, 2861232],
    [2867441, 1804655, 1370496, 1845095, 461525, 2254054, 1254418, 2696811, 792418, 2162933, 3390732, 1949039, 816691, 1379110, 1802701, 2323127, 2131862, 367570, 993605, 2520482],
    [543741, 432622, 304583, 427053, 105307, 461867, 313131, 518083, 179834, 374206, 672387, 404070, 156789, 288213, 341930, 461284, 367570, 113520, 218038, 447471],
    [1431436, 1126035, 848768, 1175587, 289147, 1261990, 767502, 1441995, 499121, 1104934, 1718966, 1143727, 404198, 792413, 928293, 1238396, 993605, 218038, 637468, 1232651],
    [4064514, 2568410, 1799821, 2823981, 615557, 3279189, 1710614, 3493968, 1018183, 2671617, 4114646, 2653183, 1032328, 1681499, 2220318, 2861232, 2520482, 447471, 1232651, 3515526]
]

LUTR910101 = [
  [11.0],
  [0.0, 32.0],
  [2.0,  2.0, 11.0],
  [1.0, -2.0,  4.0, 29.0],
  [-5.0, -6.0, -7.0, -13.0, 109.0],
  [2.0,  6.0,  3.0,  2.0, -10.0, 16.0],
  [3.0,  2.0,  2.0,  6.0, -12.0,  5.0, 15.0],
  [-5.0, -7.0, -4.0, -7.0, -15.0, -8.0, -6.0, 39.0],
  [-4.0, -1.0,  2.0, -5.0, -23.0,  2.0, -3.0, -13.0, 54.0],
  [1.0, -4.0, -3.0, -7.0, -13.0, -3.0, -3.0, -16.0, -10.0, 50.0],
  [1.0, -4.0, -4.0, -10.0, -1.0, -2.0, -4.0, -17.0, -6.0, 19.0, 45.0],
  [-1.0,  6.0, -1.0, -2.0, -16.0,  5.0,  3.0, -15.0, -8.0, -10.0, -11.0, 39.0],
  [1.0,  0.0, -1.0, -7.0, -3.0,  0.0, -4.0, -11.0, -3.0, 20.0, 24.0, -8.0, 40.0],
  [-13.0, -14.0, -11.0, -15.0, -12.0, -15.0, -18.0, -24.0, -6.0,  7.0, 11.0, -26.0, 13.0, 85.0],
  [1.0, -9.0, -8.0, -9.0, -28.0, -6.0, -3.0, -19.0, -12.0, -11.0, -10.0, -9.0, -11.0, -24.0, 55.0],
  [4.0,  1.0,  3.0,  2.0, -10.0,  2.0,  2.0, -6.0, -4.0, -5.0, -5.0, -1.0, -4.0, -14.0, -3.0, 17.0],
  [3.0, -1.0,  2.0, -2.0, -7.0,  1.0,  1.0, -12.0, -5.0,  0.0, -4.0, -3.0, -2.0, -13.0, -6.0,  4.0, 30.0],
  [-6.0,  3.0, -6.0, -10.0, -3.0, -13.0, -14.0, -12.0, -3.0,  1.0,  1.0, -19.0,  9.0, 10.0, -11.0, -7.0, -14.0, 124.0],
  [-6.0, -3.0, -4.0, -10.0,  3.0, -9.0, -10.0, -16.0,  2.0, -3.0,  2.0, -16.0,  4.0, 22.0, -17.0, -6.0, -9.0, 29.0, 64.0],
  [3.0, -3.0, -3.0, -7.0, -7.0, -2.0, -2.0, -12.0, -9.0, 24.0, 13.0, -9.0, 14.0,  0.0, -8.0, -4.0, -1.0, -1.0, -2.0, 39.0]]

ALTS910101 = [
    [3.0],
    [-3.0, 6.0],
    [0.0, -1.0, 4.0],
    [0.0, -3.0, 2.0, 5.0],
    [-3.0, -4.0, -5.0, -7.0, 9.0],
    [-1.0, 1.0, 0.0, 1.0, -7.0, 6.0],
    [0.0, -3.0, 1.0, 3.0, -7.0, 2.0, 5.0],
    [1.0, -4.0, 0.0, 0.0, -5.0, -3.0, -1.0, 5.0],
    [-3.0, 1.0, 2.0, 0.0, -4.0, 3.0, -1.0, -4.0, 7.0],
    [-1.0, -2.0, -2.0, -3.0, -3.0, -3.0, -3.0, -4.0, -4.0, 6.0],
    [-3.0, -4.0, -4.0, -5.0, -7.0, -2.0, -4.0, -5.0, -3.0, 1.0, 5.0],
    [-2.0, 2.0, 1.0, -1.0, -7.0, 0.0, -1.0, -3.0, -2.0, -2.0, -4.0, 5.0],
    [-2.0, -1.0, -3.0, -4.0, -6.0, -1.0, -4.0, -4.0, -4.0, 1.0, 3.0, 0.0, 8.0],
    [-4.0, -4.0, -4.0, -7.0, -6.0, -6.0, -6.0, -5.0, -2.0, 0.0, 0.0, -6.0, -1.0, 8.0],
    [1.0, -1.0, -2.0, -2.0, -3.0, 0.0, -1.0, -2.0, -1.0, -3.0, -3.0, -2.0, -3.0, -5.0, 6.0],
    [1.0, -1.0, 1.0, 0.0, -1.0, -2.0, -1.0, 1.0, -2.0, -2.0, -4.0, -1.0, -2.0, -3.0, 1.0, 3.0],
    [1.0, -2.0, 0.0, -1.0, -3.0, -2.0, -2.0, -1.0, -3.0, 0.0, -3.0, -1.0, -1.0, -4.0, -1.0, 2.0, 4.0],
    [-7.0, 1.0, -5.0, -8.0, -8.0, -6.0, -8.0, -8.0, -5.0, -7.0, -5.0, -5.0, -7.0, -1.0, -7.0, -2.0, -6.0, 12.0],
    [-4.0, -6.0, -2.0, -5.0, -1.0, -5.0, -4.0, -6.0, -1.0, -2.0, -3.0, -6.0, -4.0, 4.0, -6.0, -3.0, -3.0, -1.0, 8.0],
    [0.0, -3.0, -3.0, -3.0, -2.0, -3.0, -3.0, -2.0, -3.0, 3.0, 1.0, -4.0, 1.0, -3.0, -2.0, -2.0, 0.0, -8.0, -3.0, 5.0]
]


CROG050101 = [
    [4],
    [-2, 6],
    [-2, -1, 7],
    [-2, -1, 1, 7],
    [0, -4, -3, -4, 12],
    [-1, 1, 0, 0, -3, 6],
    [-1, 0, 0, 1, -4, 1, 5],
    [-1, -3, -1, -1, -3, -2, -2, 7],
    [-2, 0, 0, -1, -3, 0, -1, -2, 9],
    [-2, -3, -5, -6, -1, -3, -4, -6, -3, 5],
    [-2, -3, -4, -5, -2, -3, -4, -5, -3, 2, 5],
    [-2, 2, 0, 0, -4, 1, 1, -2, -1, -4, -3, 5],
    [-1, -2, -3, -4, -1, -2, -3, -4, -2, 1, 2, -2, 7],
    [-2, -3, -4, -5, -2, -3, -4, -5, -1, 0, 1, -4, 1, 7],
    [-1, -2, -2, -1, -3, -1, -1, -2, -2, -4, -3, -1, -3, -3, 8],
    [0, -1, 0, 0, -2, 0, -1, -1, -1, -4, -3, -1, -2, -3, -1, 4],
    [-1, -1, -1, -1, -1, -1, -1, -2, -1, -2, -2, -1, -1, -2, -2, 1, 5],
    [-3, -2, -3, -4, -2, -2, -3, -4, 0, -1, -1, -3, 0, 3, -3, -3, -2, 12],
    [-2, -2, -2, -3, -2, -2, -3, -4, 0, -1, -1, -3, 0, 3, -3, -2, -2, 3, 8],
    [-1, -3, -4, -5, 0, -3, -4, -5, -3, 3, 1, -3, 1, 0, -3, -3, -1, -2, -2, 5]
]


OGAK980101 = [
    [-4.8],
    [-7.0, -6.2],
    [-7.1, -7.3, -4.8],
    [-6.9, -7.3, -6.3, -5.0],
    [-7.7, -8.3, -8.6, -8.3, -3.2],
    [-7.0, -7.5, -7.1, -7.3, -8.3, -6.5],
    [-6.7, -7.5, -6.5, -6.4, -10.2, -6.8, -5.4],
    [-5.8, -7.5, -6.8, -6.3, -7.5, -7.6, -7.4, -4.2],
    [-7.7, -8.1, -6.8, -8.1, -9.3, -7.7, -7.8, -7.7, -6.1],
    [-7.1, -7.7, -7.6, -8.3, -9.0, -7.9, -8.3, -8.0, -8.2, -5.5],
    [-6.7, -7.9, -7.7, -7.1, -7.7, -7.4, -7.4, -8.0, -8.1, -5.5, -4.0],
    [-6.7, -6.6, -6.8, -6.9, -8.5, -6.7, -6.7, -6.8, -7.6, -8.1, -7.2, -5.5],
    [-8.0, -7.8, -7.4, -8.2, -8.7, -8.5, -8.1, -8.2, -9.7, -7.4, -7.0, -8.2, -6.7],
    [-7.9, -8.1, -8.2, -9.5, -8.9, -8.6, -8.2, -8.1, -8.2, -7.2, -6.6, -8.8, -8.5, -5.7],
    [-6.8, -7.9, -8.0, -7.3, -8.3, -8.1, -7.8, -7.2, -7.5, -7.2, -6.6, -7.5, -8.8, -8.8, -5.7],
    [-5.6, -6.9, -6.5, -5.7, -8.2, -7.0, -6.6, -6.3, -7.0, -7.2, -6.4, -6.6, -7.5, -8.3, -6.8, -4.6],
    [-6.2, -6.8, -6.4, -6.5, -7.5, -7.0, -6.8, -6.7, -8.0, -7.1, -6.2, -6.3, -7.3, -7.7, -6.7, -5.5, -5.0],
    [-9.0, -9.4, -8.6, -9.8, -12.0, -8.3, -7.9, -7.2, -9.7, -7.7, -6.8, -9.5, -7.2, -6.9, -10.4, -7.6, -7.6, -5.0],
    [-7.5, -8.4, -7.0, -7.2, -10.6, -7.3, -7.5, -7.5, -6.8, -7.4, -6.6, -7.3, -7.9, -6.0, -8.1, -7.3, -6.8, -6.5, -4.7],
    [-5.9, -7.4, -7.2, -7.1, -8.1, -7.5, -7.3, -7.3, -7.5, -5.7, -5.8, -6.7, -7.2, -7.1, -7.5, -6.8, -6.2, -7.8, -7.2, -4.8]
]

KOLA920101 = [
  [10.],
  [6.6, 10.],
  [0., 0., 10.],
  [0., 0., 9., 10.],
  [0., 0., 0., 0., 10.],
  [6.6, 9., 0., 0., 0., 10.],
  [9., 6.6, 0., 0., 0., 6.6, 10.],
  [0., 0., 0., 0., 0., 0., 0., 10.],
  [0., 5., 5., 6.6, 9., 5., 0., 0., 10.],
  [0., 0., 0., 0., 0., 0., 0., 0., 0., 10.],
  [5., 6.6, 0., 0., 0., 9., 5., 0., 0., 0., 10.],
  [6.6, 9., 0., 5., 0., 9., 9., 0., 0., 0., 9., 10.],
  [5., 9., 0., 0., 0., 5., 0., 0., 0., 0., 6.6, 5., 10.],
  [0., 9., 0., 0., 5., 6.6, 0., 0., 5., 0., 5., 5., 6.6, 10.],
  [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.],
  [0., 5., 6.6, 6.6, 9., 0., 0., 0., 9., 0., 0., 5., 0., 5., 0., 10.],
  [0., 5., 0., 0., 6.6, 5., 0., 0., 5., 0., 0., 5., 0., 5., 0., 6.6, 10.],
  [0., 6.6, 0., 0., 5., 5., 0., 0., 5., 0., 5., 0., 6.6, 9., 0., 5., 5., 10.],
  [0., 5., 0., 0., 5., 5., 0., 0., 6.6, 0., 0., 0., 0., 9., 0., 6.6, 9., 5., 10.],
  [0., 0., 0., 0., 0., 0., 0., 0., 0., 9., 0., 0., 0., 0., 0., 0., 0., 0., 0., 10.]
]

TOBD000101 = [
    [-0.17],
    [0.03, 1.01],
    [0.33, 0.82, -0.68],
    [0.58, -0.40, 0.28, -0.24],
    [-0.48, 0.80, -1.89, -0.32, -2.94],
    [-0.14, 0.50, 0.87, -0.26, -0.84, 0.73],
    [0.29, -0.91, 0.78, 0.18, 0.16, 0.48, 1.03],
    [0.43, 0.12, 0.46, -0.55, 0.14, -0.08, 0.88, -0.30],
    [0.66, -0.62, 0.95, 0.63, -2.34, 0.83, -0.17, 0.19, -3.30],
    [-0.79, 0.31, 0.48, 0.19, -0.26, 0.31, -0.47, 0.31, -0.37, -0.27],
    [-0.13, 0.28, 1.17, 0.41, -0.25, -0.22, -0.05, 0.23, -0.17, -0.58, -1.42],
    [0.18, 0.56, 0.00, -0.71, 0.45, 0.86, -0.34, 0.82, 0.79, -0.08, 0.43, 1.01],
    [-0.82, 0.40, 1.92, 0.08, -1.99, 0.16, 0.06, 0.08, -0.52, 0.03, -0.36, 0.77, -1.08],
    [-0.49, -0.89, 0.36, 0.50, -2.52, -0.65, -0.12, 0.90, -1.03, -0.72, -0.89, 0.32, -1.37, -2.38],
    [0.87, -0.59, 0.08, 0.20, -0.19, 0.24, -0.18, -0.81, -1.01, -0.33, 0.08, 0.42, -0.75, 1.41, 0.06],
    [0.18, 0.84, -0.78, 0.32, 0.47, 0.18, 0.15, -0.05, 1.17, 0.49, 0.80, -0.04, -0.20, -0.79, 0.60, 0.03],
    [-0.45, -0.19, 0.13, 0.49, -1.38, -0.20, 0.81, 0.10, 0.80, -0.29, 0.30, 0.38, -0.40, 0.32, 0.47, 0.32, -0.38],
    [-0.04, 0.23, 1.45, -0.05, -2.09, -1.14, -0.41, 0.51, 1.10, -0.63, -0.44, -0.38, -0.33, -0.80, -2.24, -0.08, -0.61, -0.97],
    [-0.08, -1.64, 0.43, 0.04, -0.65, -0.64, -0.16, -0.56, -1.02, -1.34, 0.25, -0.20, -0.19, -0.79, -0.68, -0.83, 0.67, -0.85, -2.22],
    [-0.54, 0.41, 0.71, 0.31, -0.46, 0.37, 0.34, -0.12, 0.67, -0.98, -1.03, 0.17, -0.93, -0.43, 0.32, 0.52, 0.24, -0.41, -0.50, -0.53]
]

MEHP950102 = [
    [0.75],
    [0.80, 0.90],
    [0.71, 0.88, 0.80],
    [0.56, 0.63, 0.69, 0.66],
    [0.75, 0.84, 0.72, 0.67, 1.07],
    [0.68, 0.83, 0.71, 0.64, 0.65, 0.80],
    [0.63, 0.82, 0.74, 0.58, 0.69, 0.73, 0.74],
    [0.83, 0.84, 0.71, 0.61, 0.80, 0.78, 0.87, 0.97],
    [0.79, 0.92, 0.78, 0.68, 0.69, 0.79, 0.78, 0.71, 0.99],
    [1.11, 1.23, 1.12, 1.06, 0.96, 1.10, 1.15, 1.25, 1.24, 1.33],
    [0.97, 1.05, 0.97, 0.96, 0.84, 1.07, 1.12, 1.09, 1.07, 1.21, 1.12],
    [0.65, 0.84, 0.72, 0.64, 0.79, 0.75, 0.78, 0.76, 0.82, 1.11, 0.99, 0.78],
    [0.97, 1.14, 0.92, 0.93, 0.97, 0.97, 0.96, 1.18, 0.96, 1.16, 1.06, 1.03, 1.05],
    [1.16, 1.26, 1.11, 1.17, 1.04, 1.07, 1.17, 1.30, 1.05, 1.54, 1.27, 1.11, 1.21, 1.33],
    [0.77, 1.03, 0.91, 0.75, 0.67, 0.83, 0.75, 0.75, 0.83, 1.30, 1.21, 0.92, 1.34, 1.07, 0.82],
    [0.80, 0.99, 0.84, 0.77, 0.81, 0.85, 0.92, 0.91, 0.85, 1.24, 1.09, 0.89, 1.15, 1.28, 0.87, 0.96],
    [0.97, 1.08, 0.99, 0.88, 0.93, 1.02, 1.11, 1.03, 0.91, 1.27, 1.18, 1.09, 1.11, 1.32, 0.93, 1.10, 1.16],
    [1.18, 1.33, 0.95, 1.04, 1.47, 1.17, 1.33, 1.28, 1.18, 1.71, 1.37, 1.11, 1.35, 1.31, 1.09, 1.34, 1.42, 1.22],
    [1.23, 1.25, 1.08, 1.12, 1.22, 1.11, 1.31, 1.27, 1.23, 1.51, 1.41, 1.18, 1.23, 1.34, 1.29, 1.41, 1.46, 1.29, 1.31],
    [1.05, 1.08, 1.05, 0.99, 0.91, 1.03, 1.08, 1.09, 1.13, 1.42, 1.35, 1.06, 1.22, 1.51, 1.13, 1.21, 1.27, 1.63, 1.60, 1.41]]


def normalize_aacooc(cooc):
    mx = cooc[0][0]
    mn = cooc[0][0]
    for row in cooc:
        m = max(row)
        if mx < m:
            mx = m
        m = min(row)
        if mn > m:
            mn = m
    res = list()
    for row in cooc:
        # mx = max(row)
        # mn = min(row)
        r = list()
        for e in row:
            r.append((e - mn) / (1.0 * (mx - mn)))
            res.append(r)
    return res


def aacooc_svd(cooc):
    U, s, V = numpy.linalg.svd(normalize_aacooc(cooc), full_matrices=False)
    return U

NORM_AACOOC = aacooc_svd(AACOOC)


def normalize(a):
    n = 20
    mx = a[0][0]
    mn = a[0][0]
    for i in range(n):
        for j in range(i + 1, n):
            a[i].append(a[j][i])
        m = min(a[i])
        if (mn > m):
            mn = m
        m = max(a[i])
        if (mx < m):
            mx = m
    for i in range(n):
        for j in range(n):
            a[i][j] = (a[i][j] - mn) / float(mx - mn)
    return a

LUTR910101 = normalize(LUTR910101)
ALTS910101 = normalize(ALTS910101)
CROG050101 = normalize(CROG050101)
OGAK980101 = normalize(OGAK980101)
KOLA920101 = normalize(KOLA920101)
TOBD000101 = normalize(TOBD000101)
MEHP950102 = normalize(MEHP950102)


def normalize_prop(a):
    n = 20
    mx = max(a)
    mn = min(a)
    for i in range(n):
        a[i] = (a[i] - mn) / float(mx - mn)
    return a

CHAM810101 = [
    0.52, 0.68, 0.76, 0.76, 0.62, 0.68, 0.68, 0.00, 0.70, 1.02,
    0.98, 0.68, 0.78, 0.70, 0.36, 0.53, 0.50, 0.70, 0.70, 0.76]

NORM_AAINDEX = []
for i in range(AANUM):
    NORM_AAINDEX.append(i + 1)

NORM_AAINDEX = normalize_prop(NORM_AAINDEX)
CHAM810101 = normalize_prop(CHAM810101)
